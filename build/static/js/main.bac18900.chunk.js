(this["webpackJsonplottery-react-app"]=this["webpackJsonplottery-react-app"]||[]).push([[0],{214:function(e,t,n){},216:function(e,t,n){},229:function(e,t){},238:function(e,t){},256:function(e,t){},258:function(e,t){},274:function(e,t){},275:function(e,t){},340:function(e,t){},342:function(e,t){},374:function(e,t){},376:function(e,t){},377:function(e,t){},382:function(e,t){},384:function(e,t){},390:function(e,t){},392:function(e,t){},405:function(e,t){},417:function(e,t){},420:function(e,t){},425:function(e,t){},433:function(e,t){},508:function(e,t,n){"use strict";n.r(t);var a=n(65),s=n(204),r=n.n(s),i=(n(214),n(15)),c=n.n(i),o=n(43),l=n(5),u=n(6),d=n(12),p=n(11),y=(n(216),n(54)),b=n.n(y),m=(n(202),n(8)),h=new b.a(b.a.givenProvider||"ws://localhost:7545"),x=[{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"index",type:"uint256"},{indexed:!1,internalType:"address",name:"bettor",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"bytes1",name:"challenges",type:"bytes1"},{indexed:!1,internalType:"uint256",name:"answerBlockNumber",type:"uint256"}],name:"BET",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"index",type:"uint256"},{indexed:!1,internalType:"address",name:"bettor",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"bytes1",name:"challenges",type:"bytes1"},{indexed:!1,internalType:"bytes1",name:"answer",type:"bytes1"},{indexed:!1,internalType:"uint256",name:"answerBlockNumber",type:"uint256"}],name:"DRAW",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"index",type:"uint256"},{indexed:!1,internalType:"address",name:"bettor",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"bytes1",name:"challenges",type:"bytes1"},{indexed:!1,internalType:"bytes1",name:"answer",type:"bytes1"},{indexed:!1,internalType:"uint256",name:"answerBlockNumber",type:"uint256"}],name:"FAIL",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"index",type:"uint256"},{indexed:!1,internalType:"address",name:"bettor",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"bytes1",name:"challenges",type:"bytes1"},{indexed:!1,internalType:"uint256",name:"answerBlockNumber",type:"uint256"}],name:"REFUND",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"index",type:"uint256"},{indexed:!1,internalType:"address",name:"bettor",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"bytes1",name:"challenges",type:"bytes1"},{indexed:!1,internalType:"bytes1",name:"answer",type:"bytes1"},{indexed:!1,internalType:"uint256",name:"answerBlockNumber",type:"uint256"}],name:"WIN",type:"event"},{constant:!0,inputs:[],name:"answerForTest",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"owner",outputs:[{internalType:"address payable",name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{internalType:"bytes1",name:"challenges",type:"bytes1"}],name:"betAndDistribute",outputs:[{internalType:"bool",name:"result",type:"bool"}],payable:!0,stateMutability:"payable",type:"function"},{constant:!0,inputs:[],name:"getPot",outputs:[{internalType:"uint256",name:"pot",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{internalType:"bytes1",name:"challenges",type:"bytes1"}],name:"bet",outputs:[{internalType:"bool",name:"result",type:"bool"}],payable:!0,stateMutability:"payable",type:"function"},{constant:!1,inputs:[],name:"distribute",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"bytes32",name:"answer",type:"bytes32"}],name:"setAnswerForTest",outputs:[{internalType:"bool",name:"result",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{internalType:"bytes1",name:"challenges",type:"bytes1"},{internalType:"bytes32",name:"answer",type:"bytes32"}],name:"isMatch",outputs:[{internalType:"enum Lottery.BettingResult",name:"",type:"uint8"}],payable:!1,stateMutability:"pure",type:"function"},{constant:!0,inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"getBetInfo",outputs:[{internalType:"uint256",name:"answerBlockNumber",type:"uint256"},{internalType:"address",name:"bettor",type:"address"},{internalType:"bytes1",name:"challenges",type:"bytes1"}],payable:!1,stateMutability:"view",type:"function"}],j=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).pollData=Object(o.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getPot();case 2:return e.next=4,a.getBetEvents();case 4:case"end":return e.stop()}}),e)}))),a.initWeb3=Object(o.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.ethereum){e.next=12;break}return window.web3=new b.a(window.ethereum),e.prev=2,e.next=5,window.ethereum.enable();case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.log("User denied account access: ".concat(e.t0));case 10:e.next=13;break;case 12:window.web3?(console.log("Legacy Mode"),window.web3=new b.a(b.a.currentProvider)):console.log("Non-Ethereum browser detected. You should consider trying MetaMask!");case 13:return e.next=15,h.eth.getAccounts();case 15:return t=e.sent,a.account=t[0],console.log(a.account),a.lotteryContract=new h.eth.Contract(x,"0x69bF039ED3c1Be51a491B77855245735faa7C365"),e.next=21,a.lotteryContract.methods.owner().call();case 21:e.sent;case 22:case"end":return e.stop()}}),e,null,[[2,7]])}))),a.getPot=Object(o.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.lotteryContract.methods.getPot().call();case 2:t=e.sent,n=h.utils.fromWei(t.toString(),"ether"),a.setState({pot:n});case 5:case"end":return e.stop()}}),e)}))),a.getBetEvents=Object(o.a)(c.a.mark((function e(){var t,n,s,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,a.lotteryContract.getPastEvents("BET",{fromBlock:0,toBlock:"latest"});case 3:for(n=e.sent,s=0;s<n.length;s++)(r={}).index=parseInt(n[s].returnValues.index,10).toString(),r.bettor=n[s].returnValues.bettor,r.betBlockNumber=n[s].blockNumber,r.targetBlockNumber=n[s].returnValues.answerBlockNumber.toString(),r.challenges=n[s].returnValues.challenges,r.win="Not Revealed",r.answer="0x00",t.unshift(r);console.log(t);case 6:case"end":return e.stop()}}),e)}))),a.bet=Object(o.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.eth.getTransactionCount(a.account);case 2:t=e.sent,n="0x"+a.state.challenges[0].toLowerCase()+a.state.challenges[1].toLowerCase(),a.lotteryContract.methods.betAndDistribute(n).send({from:a.account,value:5e15,gas:3e5,nonce:t}).on("transactionHash",(function(e){console.log(e)}));case 5:case"end":return e.stop()}}),e)}))),a.onClickCard=function(e){a.setState({challenges:[a.state.challenges[1],e]})},a.getCard=function(e,t){var n="";return"A"===e&&(n="\ud83c\udca1"),"B"===e&&(n="\ud83c\udcb1"),"C"===e&&(n="\ud83c\udcc1"),"D"===e&&(n="\ud83c\udcd1"),Object(m.jsx)("button",{className:t,onClick:function(){a.onClickCard(e)},children:Object(m.jsxs)("div",{className:"card-body text-center",children:[Object(m.jsx)("p",{className:"card-test"}),Object(m.jsx)("p",{className:"card-test text-center",style:{fontSize:300},children:n}),Object(m.jsx)("p",{className:"card-test"})]})})},a.state={betRecords:[],winRecords:[],failRecords:[],pot:"0",challenges:["A","B"],finalRecords:[{bettor:"0xabcd",index:"0",challenges:"ab",answer:"ab",targetBlockAnswer:"10",pot:"0"}]},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=Object(o.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initWeb3();case 2:return e.next=4,this.pollData();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(m.jsxs)("div",{className:"App",children:[Object(m.jsx)("div",{className:"container",children:Object(m.jsxs)("div",{className:"jumbotron",children:[Object(m.jsxs)("h1",{children:["Current Pot : ",this.state.pot]}),Object(m.jsx)("p",{children:"Lottery"}),Object(m.jsx)("p",{children:"Your Bet"}),Object(m.jsxs)("p",{children:[this.state.challenges[0]," ",this.state.challenges[1]]})]})}),Object(m.jsx)("div",{className:"container",children:Object(m.jsxs)("div",{className:"card-group",children:[this.getCard("A","card bg-primary"),this.getCard("B","card bg-warning"),this.getCard("C","card bg-danger"),this.getCard("D","card bg-success")]})}),Object(m.jsx)("br",{}),Object(m.jsx)("div",{children:Object(m.jsx)("button",{className:"btn btn-danger btn-lg",onClick:this.bet,children:"BET!"})}),Object(m.jsx)("br",{}),Object(m.jsx)("div",{className:"container",children:Object(m.jsxs)("table",{className:"table table-dark table-striped",children:[Object(m.jsx)("thead",{children:Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{children:"Index"}),Object(m.jsx)("th",{children:"Address"}),Object(m.jsx)("th",{children:"Challenges"}),Object(m.jsx)("th",{children:"Answer"}),Object(m.jsx)("th",{children:"Pot"}),Object(m.jsx)("th",{children:"Status"}),Object(m.jsx)("th",{children:"Answer Block Number"})]})}),Object(m.jsx)("tbody",{children:this.state.finalRecords.map((function(e,t){return Object(m.jsxs)("tr",{children:[Object(m.jsx)("td",{children:"0"}),Object(m.jsx)("td",{children:"0"}),Object(m.jsx)("td",{children:"0"}),Object(m.jsx)("td",{children:"0"}),Object(m.jsx)("td",{children:"0"}),Object(m.jsx)("td",{children:"0"}),Object(m.jsx)("td",{children:"0"})]},t)}))})]})})]})}}]),n}(a.Component);r.a.render(Object(m.jsx)(j,{}),document.getElementById("root"))}},[[508,1,2]]]);
//# sourceMappingURL=main.bac18900.chunk.js.map